{"id": "1007527", "question": "python 如何根据日期进行分组处理", "description": "<div class=\"col-md-11 col-xs-10\"><p>有一个数据框 ，</p><p>每个pid对应的日期的start end 不同</p><p>如何新产生一列分组var，</p><p>使得 var从pid  start到end  每7天是一组</p><p>比如  图中pid   2011-07-01 到 2011-07-07 var=1</p><p> 2011-07-08 到 2011-07-14 var=2</p><p>2011-07-15 到 2011-07-21 var=3</p><p>依次类推</p><p><br/></p><p>产生这个var之后 我可以根据groupby 进行分组处理</p><p><img data-filename=\"download (1).png\" src=\"data:image/png;base64,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\" style=\"width: 394px;\"/><br/></p></div>", "viewer": 2431, "tags": ["统计/机器学习", "数据预处理", "时间序列", "Python"], "answers": [{"lvl1_answer": "<div class=\"col-md-11 col-xs-10 p-r\"><p>你用date里的日期减去2011-07-01得到的天数，然后整除7就可以了</p><p>假如你的数据框叫做df，可以用下面的代码得到你要的var</p><pre><code class=\"python\">df['var'] = (pd.to_datetime(df['date']) - pd.to_datetime('2011-07-01')).dt.days // 7</code></pre><p><br/></p></div>", "lvl2_answer": ["谢谢 后来我想到的也是这个方法"]}]}