{"id": "1007581", "question": "pandas如何处理用户和商品的交互数据", "description": "<div class=\"col-md-11 col-xs-10\"><p>推荐系统中，预测下一个用户可能购买的商品，则要加入用户历史交互过的商品交互信息，该怎么把数据转换过去呢？\n</p><p>下面有一个例子：\n</p><p>原始数据：</p><pre><code class=\"python\">user_id item_id\n1 1\n1 2\n1 3</code></pre><p>转换后的数据：\n</p><p>\n</p><p><br/></p><pre><code class=\"python\">user_id item_id item_1 item_2 item_3 label\n1 1 0 0 0 2\n1 2 1 0 0 3\n1 3 1 1 0 4</code></pre><p>item_1, item_2, item_3代表之前用户交互过的商品\n</p><p>希望有大神能帮忙看看</p></div>", "viewer": 1545, "tags": ["统计/机器学习", "推荐系统", "数据预处理", "Python"], "answers": [{"lvl1_answer": "<div class=\"col-md-11 col-xs-10 p-r\"><p>感觉pandas的crosstab可以满足你的要求</p><p><a href=\"https://pandas.pydata.org/pandas-docs/version/0.22/generated/pandas.crosstab.html\" target=\"_blank\">pandas.crosstab</a><br/></p></div>", "lvl2_answer": ["好像可以，感谢！"]}, {"lvl1_answer": "<div class=\"col-md-11 col-xs-10 p-r\"><p>Pandas中除了crosstab, pivot_table也可以实现。</p><pre> #crosstab</pre><pre><code class=\"python\">df = pd.DataFrame([[1, 1], [1, 2], [1, 3],[2,1],[2,2],[2,2]],\n     columns=['user_id', 'item_id'])\npd.crosstab([df.user_id, df.item_id], df.item_id)</code></pre><pre>#pivot_table</pre><pre><code class=\"python\">pd.pivot_table(df,index = ['user_id', 'item_id'], \n               columns='item_id', values='item_id',\n               aggfunc=len, fill_value=0)</code></pre><p><img data-filename=\"pivot_table.png\" src=\"data:image/png;base64,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\" style=\"width: 172px;\"/><br/></p><p><br/></p></div>", "lvl2_answer": []}]}