{"id": "1022134", "question": "怎么用pyspark取出hive表里的json串中某一个key的值？", "description": "<div class=\"col-md-11 col-xs-10\"><p>比如一个hive表里有id, field1, field2这些字段，field2是一个很长json串，里面有几十个key，我只需要提取json串中body这个key，用pyspark该如何操作呢？</p></div>", "viewer": 2352, "tags": ["算法/数据结构/数据库", "Spark", "Hive"], "answers": [{"lvl1_answer": "<div class=\"col-md-11 col-xs-10 p-r\"><p>用json_tuple提取，格式为json_tuple(json_field, key)</p><p>按照你的字段名字，可以写成下面这样</p><pre><code class=\"python\">from pyspark.sql.functions import json_tuple, col\n\ndata = spark.table('my_table').withColumn('body_text', json_tuple(col('field2'), 'body'))</code></pre><p><br/></p></div>", "lvl2_answer": []}]}