{"id": "1005782", "question": "如何处理片段式停车数据", "description": "<div class=\"col-md-11 col-xs-10\"><p>我现在有停车场的停车数据，大体的数据如下：</p><p><br/></p><pre><code class=\"R\">df &lt;- data.frame(\"carpark_No\" = c(\"A1\", \"A2\", \"B3\", \"C9\", \"A1\", \"B3\"), \n                 \"entry_date\" = c(\"1/6/2019\", \"1/6/2019\", \"1/6/2019\", \"1/6/2019\", \"1/6/2019\", \"1/6/2019\"), \n                 \"entry_time\" = c(\"8:30am\", \"9:00am\", \"10:35am\", \"9:33am\", \"7:50pm\", \"8:01am\"), \n                 \"exit_date\" = c(\"2/6/2019\", \"1/6/2019\", \"3/6/2019\", \"1/6/2019\", \"2/6/2019\", \"1/6/2019\"), \n                 \"exit_time\" = c(\"5:30pm\", \"9:00pm\", \"4:35am\", \"6:00pm\", \"9:00am\", \"1:00pm\"))</code></pre><p><img data-filename=\"download (1).png\" src=\"data:image/png;base64,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\" style=\"width: 536.333px; height: 198.061px;\"/><br/></p><p>注释：</p><p>carpark_No: 停车场号码，区分不同的停车场</p><p>entry_date: 每辆车进入停车场的日期</p><p>entry_time: 每辆车进入停车场的时间</p><p>exit_date: 每辆车出停车场的日期</p><p>exit_time: 每辆车出停车场的时间</p><p><br/></p><p>总的数据非常多，每一行代表一辆车进出停车场，目前我想先从停车位的占有率来入手，占有率 = 真实占有车位/总车位数， 对于真实占有车位的话，只能按时间段来算（对“点时间”和“进入时间”和“出去时间”进行对比），但是我现在有的数据是5年的，所以非常多，把时间段定的太小不太现实，希望大神能指点下，如何进行分析，除了占有率以外，其他的应用也可以，希望大家给出意见，非常感谢!</p></div>", "viewer": 3262, "tags": ["统计/机器学习", "数据预处理", "时间序列", "数据可视化", "应用场景"], "answers": [{"lvl1_answer": "<div class=\"col-md-11 col-xs-10 p-r\"><p>这个数据集感觉挺有意思的。占用率可以从两个方向看：</p><p>1）每个停车场每年的占用率，每个停车场可以得到5个数据点</p><p>2）每个停车场每个小时的占用率，然后每个停车场可以得到24个数据点</p><p>除了占用率，还有进入停车场时间点，和出停车场时间点。可以做个直方图，横坐标是24个小时，从0到23，纵坐标是比重。</p><p>还有，你可以做平均停车时长的计算，就是两个时间相减，同样也可以做直方图。</p></div>", "lvl2_answer": ["非常感谢你的回复！\n你说的两个方向我很赞同，我首先考虑要做的就是每年的比较，因为数据是五年的，想看一下大概的趋势，但是每年的跨度很大，我现在有的数据是“进入时间”和“出去的时间”，要计算每年的占有率，还是要先计算每天的占有率先。\n\n问题1，要计算每天的占有率，我需要知道真实占有车位的数目，这个用数据算的话，是无法直接得到的，因为同一个停车位，一天之内，会有不同的车停在上面，上一辆车走了以后，过一段时间就会有下一辆车，这样如果是group_by(停车场）%&gt;% tally()算出来的就是一天内进进出出的所有车的数目，一般来说是大于总停车位的，因此，我需要一个算法，确定一个更小的时间段内，真实占有停车位数目。\n\n问题二， 如果我得到了每一天的占有率数目，如何得到每一年的占有率，一般我想到的就是做一个平均数，sum/365，但是还有没有其他更好的方法呢，比如去分析每一个停车场的分布（boxplot)等等\n\n希望各位前辈可以指点我一下，我刚开始做数据，对于大方向有些茫然。感谢"]}, {"lvl1_answer": "<div class=\"col-md-11 col-xs-10 p-r\"><p>我觉得你可以用采样的方法来估计占有率。</p><p>比如你想估计停车场A1在2019年1月5日上午9点到10点的占用率，你可以采样3个时间点</p><p>t1 = 2019-01-05 09:15am, t2 = 2019-01-05 09:30am, t3 = 2019-01-05 09:45am</p><p>然后你再计算entry_date_entry_time &lt;= t1 &lt;= exit_date_exit_time的行数，这个行数就是t1时刻在A1停车场内的车辆的数量。同理，你也可以计算t2，t3时刻的占用率。</p><p>t1，t2，t3三个点的均值可以作为整个9点到10点时间段的估计值。</p><p>这样计算量会小很多。</p></div>", "lvl2_answer": []}, {"lvl1_answer": "<div class=\"col-md-11 col-xs-10 p-r\"><p>这个问题和你的挺类似的，参考一下吧</p><p><a href=\"https://answers.microsoft.com/en-us/msoffice/forum/all/please-help-how-to-calculate-occupancy-rate/073471ba-6356-4b9f-9235-662062670b84\" target=\"_blank\">How To Calculate Occupancy Rate. (Parking)</a><br/></p></div>", "lvl2_answer": []}]}