{"id": "1003773", "question": "auto-encoder异常检测的问题，无标签情况下怎么进行预测？", "description": "<div class=\"col-md-11 col-xs-10\"><p>看到最新的一期auto encoder用于信用卡欺诈检测，进行重建误差的时候，已明确具体的正负样本，即数据是存在label标签的，这样子绘制reconstruction的mse、mae确实很清楚的看到欺诈样本的误差较大。但在数据集没有label的情况下怎么进行预测测试集中的欺诈样本呢，或者说怎么设定reconstruction MSE/MAE的threshold呢，通过threshold来确定？</p></div>", "viewer": 3657, "tags": ["统计/机器学习", "无监督学习", "深度学习", "数据预处理"], "answers": [{"lvl1_answer": "<div class=\"col-md-11 col-xs-10 p-r\"><p><span style=\"font-size: 14px;\">这里有两个步骤:</span></p><p><span style=\"font-size: 14px;\">1. 先unsupervised learning，训练一个autoencoder得到MSE score。MSE=autoencoder(x)。loss中只有input$x$，并没有label$y$。</span></p><p><span style=\"font-size: 14px;\">2.再根据MSE得到一个binary classifier，目的是确定一个threshold让总体error最小。比如下图中横轴是MSE。最终目的是让typeI和type II error的加权和最小。</span></p><span style=\"font-size: 14px;\"><span style=\"font-size: 14px;\">$argmin_c [w_0 \\int p(MSE&gt;c|y=0) + w_1 \\int p(MSE&gt;c|y=1)]$</span><c span=\"\"><br/><p><span style=\"font-size: 14px;\">如果对positive/negative平均看待,$w_1=P(y=1),w_0=P(y=0)$。也可以另外建模。</span></p><p><span style=\"font-size: 14px;\">如果已知$y$,可以估计$p(MSE|y=1)$和$p(MSE|y=0)$。否则只能假设这两个分布。粗糙一点，也可以人为设定$c$，比如$P(MSE&gt;c)=0.001$。</span></p><p><img data-filename=\"pngzealing.png\" src=\"data:image/png;base64,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\" style=\"width: 537.333px; height: 147.671px;\"/><br/></p><p><span style=\"font-size: 14px;\">-----------------------------------------------------------------</span></p><p><span style=\"font-size: 14px;\">第一步应用autoencoder中，有个假设是negative 和positive的pattern不同：在某个基（basis）坐标系中positive是远离negative的clusters。只要找到一个basis，能很好表达negative，并且很大概率不能很好表达positive，这样就能在这个basis上区分positive/negative。</span></p><p><span style=\"font-size: 14px;\">autoencoder学习的是数据的nonlinear sparse rep</span><span style=\"font-size: 14px;\">resentation，</span><span style=\"font-size: 1rem;\"><span style=\"font-size: 14px;\">中间层的Z code就是一个m维的非线性basis。假设要表达所有positive/negative需要n维，[z1,z2,...zn]，而表达negative只需要m维，m</span><n span=\"\"><span style=\"font-size: 14px;\">因为数据中negative占绝大多数，所以autoencoder主要学习negative的pattern，很大概率会忽略positive的需求。</span></n></span></p><p><span style=\"font-size: 14px;\">举个例子，一只猪混到一群猴子中，而且对它们只进行爬树的考试。最后根据爬树的结果，很容易就把猪找出来了。而autoencoder学习的是如何在[吃饭，跑步，爬树，跳高，...]等考试中把爬树找出来。</span></p><p><br/></p></c></span></div>", "lvl2_answer": ["谢谢老哥，醍醐灌顶"]}, {"lvl1_answer": "<div class=\"col-md-11 col-xs-10 p-r\"><p>好像的确挺不好办的，很多时候非监督学习也是有ground truth的。但是如果完全不知道真实情况的非监督异常检验，那就只能凭直觉或者应用场景了。</p><p>比如你知道0.1%的信用卡有异常，那么你的threshold就可以选择重建误差最大的0.05%或者0.1%，基于你是想保守点还是冒险点了。</p></div>", "lvl2_answer": ["谢谢老哥回答， 之前也有这样想过。虽然合理，但觉得还是简单了些。"]}]}