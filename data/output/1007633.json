{"id": "1007633", "question": "pyspark获取当月的最后一天的日期？", "description": "<div class=\"col-md-11 col-xs-10\"><p>比如我的pyspark sql dataframe里有一列日期</p><p>dates</p><p>2020-01-20</p><p>2020-01-25</p><p>2020-02-01</p><p>2020-02-29</p><p><br/></p><p>我想返回的是加工后的一列，这一列对应着每一行中dates日期所在的月的最后一天。比如上面的结果应该是</p><p>last_day_a_month</p><p>2020-01-31</p><p>2020-01-31</p><p>2020-02-29</p><p>2020-02-29</p><p><br/></p><p>在pyspark里我该怎么操作？</p></div>", "viewer": 1694, "tags": ["算法/数据结构/数据库", "Spark"], "answers": [{"lvl1_answer": "<div class=\"col-md-11 col-xs-10 p-r\"><p>先引用一下pyspark的functions</p><pre><code class=\"python\">import pyspark.sql.functions as F</code></pre><p>然后用Functions中的last_day函数就可以得到当月的最后一天</p><pre><code class=\"python\">select(F.last_day(F.col('dates')).alias('last_day_of_month'))</code></pre><p><br/></p></div>", "lvl2_answer": []}]}