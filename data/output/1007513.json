{"id": "1007513", "question": "pyspark里怎么把一列日期转成是全年的第几周？", "description": "<div class=\"col-md-11 col-xs-10\"><p>比如有一列日期，是yyyy-mm-dd格式的字符，我想把它转成第几星期，比如2020-01-13就是第3周。</p><p>想要的效果是：</p><p>2020-01-13 ===== 3</p><p>2020-01-15 ===== 3</p><p>2020-01-29 ===== 5</p><p>2020-02-07 ===== 6</p><p><br/></p></div>", "viewer": 2715, "tags": ["统计/机器学习", "数据预处理", "Python", "mysql"], "answers": [{"lvl1_answer": "<div class=\"col-md-11 col-xs-10 p-r\"><p>pyspark的函数里有date_format，可以让日期变为week of year</p><pre><code class=\"python\">from pyspark.sql import functions as F</code></pre><p>把日期dt这列变成第几周的代码是</p><pre><code class=\"python\">F.date_format(F.col('dt'), 'w')</code></pre><p>然后得到的数就是表示是该年度中的第几周</p></div>", "lvl2_answer": []}, {"lvl1_answer": "<div class=\"col-md-11 col-xs-10 p-r\"><p><br/></p><pre><code class=\"python\">df2 = pd.DataFrame({'date':['2020-01-21 10:20:23', '2020-01-22 11:20:23', '2020-02-21 10:50:33']})\ndf2['date3']=pd.to_datetime(df2.date).dt.weekofyear</code></pre><p><img data-filename=\"download (3).png\" src=\"data:image/png;base64,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\" style=\"width: 50%;\"/></p></div>", "lvl2_answer": ["你这个是pandas，题目里应该问的是pyspark"]}]}