{"id": "1002561", "question": "怎么理解推荐系统中的NDCG？", "description": "<div class=\"col-md-11 col-xs-10\"><p>怎么理解推荐系统中的NDCG？看起来非常复杂，有清楚的同学可以介绍下吗？</p><p>如果能有浅显的例子就更好啦，非常感谢！</p></div>", "viewer": 22946, "tags": ["统计/机器学习", "推荐系统", "模型验证"], "answers": [{"lvl1_answer": "<div class=\"col-md-11 col-xs-10 p-r\"><p>可能大家接触比较多的是MAP，MAP考虑的是0和1的排序。而NDCG则是考虑到评分的排序。</p><p>说到NDCG就需要从CG开始说起。</p><p>CG（cumulative gain，累计增益）可以用于评价基于打分/评分的个性推荐系统。假设我们推荐$k$个物品，这个推荐列表的$CG_k$计算公式如下：\r\n</p><p>$$CG_k=\\sum_{i=1}^k \\text{rel}_i.$$\r\n</p><p>$\\text{rel}_i$表示第$k$个物品的相关性或者评分。假设我们共推荐$k$个电影，$rel_i$可以是用户对第$i$部电影的评分。\r\n</p><p>比如豆瓣给用户推荐了五部电影，\r\n</p><p>$M_1$,$M_2$,$M_3$,$M_4$,$M_5$，\r\n<span style=\"font-size: 1rem;\"></span></p><p>该用户对这五部电影的评分分别是\r\n</p><p>5, 3, 2, 1, 2\r\n</p><p>那么这个推荐列表的CG等于$$CG_5=5+3+2+1+2=13.$$\r\n</p><p>\n</p><p>CG没有考虑推荐的次序，在此基础之后我们引入对物品顺序的考虑，就有了DCG(discounted CG)，折扣累积增益。公式如下：\r\n<span style=\"font-size: 1rem;\"></span></p><p>$$DCG_k=\\sum_{i=1}^k \\frac{2^{\\text{rel}_i}-1}{\\log_2(i+1)}.$$\r\n</p><p>比如豆瓣给用户推荐了五部电影，\r\n</p><p>$M_1$,$M_2$,$M_3$,$M_4$,$M_5$，\r\n</p><p>该用户对这五部电影的评分分别是\r\n</p><p>5, 3, 2, 1, 2\r\n</p><p>那么这个推荐列表的DCG等于$$DCG_5=\\frac{2^5-1}{\\log_2 2}+\\frac{2^3-1}{\\log_2 3}+\\frac{2^2-1}{\\log_2 4}+\\frac{2^1-1}{\\log_2 5}+\\frac{2^2-1}{\\log_2 6}=31+4.4+1.5+0.4+1.2=38.5$$\r\n</p><p>\n</p><p>\r\nDCG没有考虑到推荐列表和每个检索中真正有效结果个数，所以最后我们引入NDCG(normalized discounted CG)，顾名思义就是标准化之后的DCG。</p><p>$$NDCG_k=\\frac{DCG_k}{IDCG_k}$$</p><p>其中$IDCG$是指ideal DCG，也就是完美结果下的DCG。</p><p>继续上面的例子，如果相关电影一共有7部</p><p>$M_1$,$M_2$,$M_3$,$M_4$,$M_5$,$M_6$,$M_7$</p><p>该用户对这七部电影的评分分别是\r\n</p><p>5, 3, 2, 1, 2\r\n, 4, 0</p><p>把这7部电影按评分排序</p><p>5, 4, 3, 2, 2, 1, 0</p><p>这个情况下的完美DCG是$$IDCG_5=\\frac{2^5-1}{\\log_2 2}+\\frac{2^4-1}{\\log_2 3}+\\frac{2^3-1}{\\log_2 4}+\\frac{2^2-1}{\\log_2 5}+\\frac{2^2-1}{\\log_2 6}=31+9.5+3.5+1.3+1.2=46.5$$\r\n</p><p>所以</p><p>$$NDCG_5 = \\frac{DCG_5}{IDCG_5}=\\frac{38.5}{46.5}=0.827$$</p><p>NDCG是0到1的数，越接近1说明推荐越准确。</p></div>", "lvl2_answer": ["非常清晰，十分感谢！"]}]}