{"id": "1002758", "question": "为什么梯度的反方向是函数下降最快的方向？", "description": "<div class=\"col-md-11 col-xs-10\"><p>梯度下降法是用梯度的反方向作为下降方向，那么为什么函数在梯度的反方向上下降是最快的呢？</p></div>", "viewer": 6838, "tags": ["数学", "数值计算", "最优化"], "answers": [{"lvl1_answer": "<div class=\"col-md-11 col-xs-10 p-r\"><p>先以一个二元函数为例，$f(x,y)$</p><p>我们知道梯度是函数在各坐标轴方向上的变化率，比如梯度$\\nabla f(x_0,y_0)$是函数在$(x_0,y_0)$上关于$x$轴和$y$轴的变化率</p><p>$$\\nabla f(x,y)=\\begin{pmatrix}f_x(x,y) \\\\ f_y(x,y)\\end{pmatrix}$$</p><p>对于一个任意单位方向$u$，假设$\\alpha$是$u$和$x$轴的夹角，那么函数$f(x,y)$在$u$这个方向上的变化率为</p><p>$$f_x(x,y) \\cos \\alpha + f_y(x,y) \\sin \\alpha=\\nabla f(x,y)^T\\begin{pmatrix}f_x(x,y) \\\\ f_y(x,y)\\end{pmatrix}=\\nabla f(x,y)^Tu$$</p><p>也就是两个向量的点积。我们知道向量点积的结果和向量本身的大小以及两者夹角相关，假设$\\nabla f(x,y)$和$u$的夹角为$\\theta$，那么函数$f(x,y)$在$u$这个方向上的变化率可以写成</p><p>$$\\nabla f(x,y)^Tu=\\|\\nabla f(x,y)\\|_2 \\|u\\|_2 \\cos \\theta=\\|\\nabla f(x,y)\\|_2\\cos \\theta$$</p><p>$\\cos \\theta$的取值范围为$[-1, 1]$。当$\\cos \\theta = 1$时，函数变化率最大（上升最快），此时$u$和梯度$\\nabla f(x,y)$同方向；当$\\cos \\theta = -1$时，函数变化率最小（下降最快），此时$u$是梯度$\\nabla f(x,y)$的反方向。</p><p><br/></p><p>推广到$n$元函数，函数$f$在单位方向$u$的变化率为</p><p>$$\\nabla f^T u$$</p><p>假设$\\nabla f(x,y)$和$u$的夹角为$\\theta$，同样函数$f$在$u$这个方向上的变化率可以写成</p><p>$$\\nabla f^Tu=\\|\\nabla f\\|_2\\|u\\|_2 \\cos \\theta=\\|\\nabla f\\|_2\\cos \\theta$$</p><p>变化率由$\\cos \\theta$决定。$u$和梯度$\\nabla f(x,y)$同方向，上升最快；$u$和梯度$\\nabla f(x,y)$反方向，下降最快。</p><p><br/></p></div>", "lvl2_answer": ["醍醐灌顶，茅塞顿开！", "赞！"]}, {"lvl1_answer": "<div class=\"col-md-11 col-xs-10 p-r\"><p><span style=\"font-size: 14px;\">假设$v$为任意方向的单位向量,$f(x)$在$x$可导，沿$v$的</span><a href=\"https://en.wikipedia.org/wiki/Directional_derivative\" target=\"_blank\"><span style=\"font-size: 14px;\">方向导数</span></a><span style=\"font-size: 14px;\">是</span></p><p><span style=\"font-size: 14px;\">$$\\nabla_vf(x)=\\lim_{h\\to 0} \\frac{f(x+hv)-f(x)}{h}=\\nabla f(x) \\cdot v=|\\nabla f(x)|cos\\theta$$</span></p><p><span style=\"font-size: 14px;\">$\\theta$是$\\nabla f(x)$和$v$夹角。</span><span style=\"font-size: 14px;\">左边表示当$x$变化$hv$时，$f(x+hv)-f(x)$的变化量，它等于梯度$\\nabla f(x)$和$v$的内积。当二者方向相反时， $\\theta=\\pi$，此时$f(x)$改变的绝对值最大。</span></p><p><span style=\"font-size: 14px;\">也可以从泰勒级数展开来看$f(x+\\delta v)=f(x)+\\delta \\nabla f(x) \\cdot v+\\cdots$ , $\\delta$是很小的步长。第二项就是一阶增量，正比于方向导数。</span></p></div>", "lvl2_answer": ["嗯，有道理", "这个证明很简洁"]}, {"lvl1_answer": "<div class=\"col-md-11 col-xs-10 p-r\"><p>因为这个时候$cos\\theta=-1$，最小。</p><p>$\\theta$是梯度和$\\Delta x$之间的夹角</p></div>", "lvl2_answer": []}, {"lvl1_answer": "<div class=\"col-md-11 col-xs-10 p-r\"><span style=\"font-size: 14px;\">梯度即在局域内导数取最大值的方向，因此梯度的方向也是函数最快增大的方向，而梯度的反方向也就是函数下降的最快的方向</span></div>", "lvl2_answer": []}]}