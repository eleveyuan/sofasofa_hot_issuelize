{"id": "1001678", "question": "sklearn里计算roc_auc_score，报错ValueError: bad input shape", "description": "<div class=\"col-md-11 col-xs-10\"><p>用sklearn的DecisionTreeClassifer训练模型，然后用roc_auc_score计算模型的auc。代码如下</p><pre><code class=\"python\">clf = DecisionTreeClassifier(criterion='gini', max_depth=6, min_samples_split=10, min_samples_leaf=2)\nclf.fit(X_train, y_train)\ny_pred = clf.predict_proba(X_test)\nroc_auc = roc_auc_score(y_test, y_pred)</code></pre><p>报错信息如下</p><pre><code class=\"python\">/Users/wgg/anaconda/lib/python2.7/site-packages/sklearn/metrics/ranking.pyc in _binary_clf_curve(y_true, y_score, pos_label, sample_weight)\n    297     check_consistent_length(y_true, y_score)\n    298     y_true = column_or_1d(y_true)\n--&gt; 299     y_score = column_or_1d(y_score)\n    300     assert_all_finite(y_true)\n    301     assert_all_finite(y_score)\n\n/Users/wgg/anaconda/lib/python2.7/site-packages/sklearn/utils/validation.pyc in column_or_1d(y, warn)\n    560         return np.ravel(y)\n    561 \n--&gt; 562     raise ValueError(\"bad input shape {0}\".format(shape))\n    563 \n    564 \n\nValueError: bad input shape (900, 2)</code></pre><p>这个是怎么回事？有人遇到过吗？</p><p><br/></p></div>", "viewer": 10108, "tags": ["统计/机器学习", "监督式学习", "模型验证", "Python"], "answers": [{"lvl1_answer": "<div class=\"col-md-11 col-xs-10 p-r\"><p>目测是你的y_pred出了问题，你的y_pred是(900, 2)的array，也就是有两列。</p><p>因为predict_proba返回的是两列。<a href=\"http://sofasofa.io/forum_main_post.php?postid=1000600\" target=\"_blank\">predict_proba的用法参考这里</a>。</p><p>简而言之，你上面的代码改成这样就可以了。</p><pre><code class=\"python\">y_pred = clf.predict_proba(X_test)[:, 1]\r\nroc_auc = roc_auc_score(y_test, y_pred)</code></pre><p><br/></p></div>", "lvl2_answer": ["果然是predict_proba的输出的问题，太感谢了！"]}]}