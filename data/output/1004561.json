{"id": "1004561", "question": "pandas返回组内某列值最大的行？", "description": "<div class=\"col-md-11 col-xs-10\"><p>比如一个dataframe有很多列，包括'id', 'date', 'location', 'sales', 'amount', 'type'</p><p>我想返回每天sales最大的那一行。我现在做的是</p><pre><code class=\"python\">df.groupby(['date'], as_index=False).agg({'sales': max})</code></pre><p>但是这个只能返回date和sales，没有id, location, amount, type这类信息。</p><p>这么能得到每天sales最大的完整的行？</p></div>", "viewer": 4676, "tags": ["统计/机器学习", "数据预处理", "Python"], "answers": [{"lvl1_answer": "<div class=\"col-md-11 col-xs-10 p-r\"><p>只用groupby和agg估计做不到。我觉得你可以对date和sales排序，然后对date<span style=\"font-size: 1rem;\">去重，只保留每个date的最后一行也就是sales最大的一行</span></p><pre><code class=\"python\">df.sort_values(['date', 'sales']).drop_duplicates(['date'], keep='last')</code></pre></div>", "lvl2_answer": ["太6了，原来不需要用groupby啊，多谢！"]}]}