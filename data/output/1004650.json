{"id": "1004650", "question": "用uci的crimes做了一个线性回归，test很差", "description": "<div class=\"col-md-11 col-xs-10\"><p><br/></p><pre><code class=\"python\">import numpy as np\nimport pandas as pd\nimport os\nimport matplotlib.pyplot as plt\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LinearRegression\n\n# Read the data\n#crimesDF =pd.read_csv(\"crimes.csv\",encoding=\"ISO-8859-1\")\ncrimesDF =pd.read_csv(\"communities.csv\",encoding=\"ISO-8859-1\")\n\n#Remove the 1st 7 columns\nprint(crimesDF.shape[1]) #128\ncrimesDF1=crimesDF.iloc[:,6:crimesDF.shape[1]]\n\n# Convert to numeric\ncrimesDF2 = crimesDF1.apply(pd.to_numeric, errors='coerce')\n\n# Impute NA to 0s\ncrimesDF2.fillna(0, inplace=True)\n\n# Select the X (feature vatiables - all)\nX=crimesDF2.iloc[:,0:120]\n\n# Set the target\ny=crimesDF2.iloc[:,121]\nprint(y)\nX_train, X_test, y_train, y_test = train_test_split(X, y,random_state = 0)\n\n# Fit a multivariate regression model\nlinreg = LinearRegression().fit(X_train, y_train)\n\n# compute and print the R Square\nprint('R-squared score (training): {:.3f}'.format(linreg.score(X_train, y_train)))\nprint('R-squared score (test): {:.3f}'.format(linreg.score(X_test, y_test)))\n\n## R-squared score (training): 0.78\n## R-squared score (test): 0.03</code></pre><p>test的score只有0.03 不知道是什么原因呢</p></div>", "viewer": 2462, "tags": ["统计/机器学习", "回归分析", "Python"], "answers": [{"lvl1_answer": "<div class=\"col-md-11 col-xs-10 p-r\"><p>看样子像过拟合了，应该是你变量太多，有多重线性相关了。</p></div>", "lvl2_answer": []}, {"lvl1_answer": "<div class=\"col-md-11 col-xs-10 p-r\"><p>你换个random forest试试，再用cv调一下参</p></div>", "lvl2_answer": []}]}