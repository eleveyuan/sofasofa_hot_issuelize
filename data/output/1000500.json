{"id": "1000500", "question": "什么是K-Modes（K众数）聚类法？", "description": "<div class=\"col-md-11 col-xs-10\"><p>最近听说了一个K-Modes聚类法，听说是基于K-Means在分类特征上改良的聚类算法。但是没有找到相关的资料，有知道算法的具体细节的吗？</p><p>谢谢！</p></div>", "viewer": 15903, "tags": ["统计/机器学习", "无监督学习"], "answers": [{"lvl1_answer": "<div class=\"col-md-11 col-xs-10 p-r\"><p><span style=\"font-size: 14px;\">我对K-Modes Clustering（K众数聚类）还算熟悉。我可以讲一讲。</span></p><p><br/></p><p><span style=\"font-size: 14px;\">K-Modes和K-Means非常类似。</span></p><p><span style=\"font-size: 14px;\">相同点：我们在算法开始前自己设定K，也就是聚类的个数；然后再自己设定K个初始中心点，所有样本点被聚类到离自己最近的那个中心点；根据每个聚类，重新计算中心点，所有样本点再重新被聚类。如此往复，直到每个样本点的归属不再改变或者达到某个预设的收敛条件。</span></p><p><span style=\"font-size: 14px;\">不同点：K-Means是用每个聚类中的均值（mean）做中心点，K-Modes是用每个聚类中的众数（mode）做中心点。距离的定义也不同，通常K-Means较多使用欧式距离，K-Modes一般是汉明距离，也就是对于每个特征来说，如果不同记为1，相同则为0。</span></p><p><span style=\"font-size: 14px;\"><br/></span></p><p><span style=\"font-size: 14px;\"><br/></span></p><p><span style=\"font-size: 14px;\">我可以举个例子。比如我们有10款手机需要聚类，我们关于这10款手机的数据都是分类数据（categorical）。</span></p><p><span style=\"font-size: 14px;\">手机        国家        人群        颜色</span></p><p><span style=\"font-size: 14px;\">1              中          青年           白</span></p><p><span style=\"font-size: 14px;\">2              日          青年           黑</span></p><p><span style=\"font-size: 14px;\">3              中          青年           蓝</span></p><p><span style=\"font-size: 14px;\">4              中          青年           黑</span></p><p><span style=\"font-size: 14px;\">5              日          青年           白</span></p><p><span style=\"font-size: 14px;\">6              日          中年           黑</span></p><p><span style=\"font-size: 14px;\">7              美          中年           蓝</span></p><p><span style=\"font-size: 14px;\">8              美          中年           白</span></p><p><span style=\"font-size: 14px;\">9              中          中年           黑</span></p><p><span style=\"font-size: 14px;\">10            美          中年           黑 </span></p><p><span style=\"font-size: 14px;\"><br/></span></p><p><span style=\"font-size: 14px;\">假定我们选择聚类的数量K=2，初始点为手机1（中，青年，白）和手机6（日，中年，黑）。</span></p><p><span style=\"font-size: 14px;\">下面开始计算距离。</span></p><p><span style=\"font-size: 14px;\">手机        与手机1的距离        与手机6的距离</span></p><p><span style=\"font-size: 14px;\">2                    2                                </span><span style=\"color: rgb(206, 0, 0); font-weight: bold; font-size: 14px;\">1</span></p><p><span style=\"font-size: 14px;\">3                    </span><span style=\"color: rgb(206, 0, 0); font-weight: bold; font-size: 14px;\">1</span><span style=\"font-size: 14px;\">                                3</span></p><p><span style=\"font-size: 14px;\">4                    </span><span style=\"color: rgb(206, 0, 0); font-weight: bold; font-size: 14px;\">1</span><span style=\"font-size: 14px;\">                                2</span></p><p><span style=\"font-size: 14px;\">5                    </span><span style=\"color: rgb(206, 0, 0); font-weight: bold; font-size: 14px;\">1 </span><span style=\"font-size: 14px;\">                               2</span></p><p><span style=\"font-size: 14px;\">7                    3                               </span><span style=\"color: rgb(206, 0, 0); font-weight: bold; font-size: 14px;\"> 2</span></p><p><span style=\"font-size: 14px;\">8                   </span><span style=\"font-weight: bold; color: rgb(231, 148, 57); font-size: 14px;\"> </span><span style=\"font-weight: bold; color: rgb(206, 0, 0); font-size: 14px;\">2</span><span style=\"color: rgb(247, 173, 107); font-size: 14px;\"> </span><span style=\"font-size: 14px;\">                              </span><span style=\"color: rgb(206, 0, 0); font-weight: bold; font-size: 14px;\"> </span><span style=\"font-weight: bold; color: rgb(231, 148, 57); font-size: 14px;\">2</span></p><p><span style=\"font-size: 14px;\">9                    2                                </span><span style=\"color: rgb(206, 0, 0); font-weight: bold; font-size: 14px;\">1</span></p><p><span style=\"font-size: 14px;\">10                  3                                </span><span style=\"color: rgb(206, 0, 0); font-weight: bold; font-size: 14px;\">1 </span><span style=\"font-size: 14px;\">              </span></p><p><span style=\"font-size: 14px;\">  </span></p><p><span style=\"font-size: 14px;\">对于手机8来说，出现了打平，我们可以随机选择一个，假定手机8属于手机1的聚类。</span></p><p><span style=\"font-size: 14px;\"><br/></span></p><p><span style=\"font-size: 14px;\">聚类1：手机1, 3, 4, 5, 8</span></p><p><span style=\"font-size: 14px;\">手机                国家                人群                颜色\n</span></p><p><span style=\"font-size: 14px;\">1                中             青年                   白\n</span></p><p><span style=\"font-size: 14px;\">3                中             青年          蓝\n</span></p><p><span style=\"font-size: 14px;\">4                中                      青年                   黑\n</span></p><p><span style=\"font-size: 14px;\">5                日             青年          白\n</span></p><p><span style=\"font-size: 14px;\">8                美             中年                   白\n</span></p><p><span style=\"font-size: 14px;\">\n</span><span style=\"font-size: 14px;\"> 我们下面计算聚类1的新中心。</span></p><p><span style=\"font-size: 14px;\">“国家”，中国三次，日本美国各一次，国家的众数是中国。</span></p><p><span style=\"font-size: 14px;\">“人群”，青年四次，中年一次，众数是青年。</span></p><p><span style=\"font-size: 14px;\">“颜色”，白色是众数。</span></p><p><span style=\"font-size: 14px;\">所以聚类1的中心依然是（中，青年，白）。</span></p><p><br/></p><p><span style=\"font-size: 14px;\">聚类2：手机2, 6, 7, 9, 10</span></p><p><span style=\"font-size: 14px;\">手机                国家                人群                颜色\n</span></p><p><span style=\"font-size: 14px;\">2 </span><span style=\"font-size: 14px;\">            </span><span style=\"font-size: 14px;\">             日 </span><span style=\"font-size: 14px;\">           </span><span style=\"font-size: 14px;\">青年 </span><span style=\"font-size: 14px;\">            </span><span style=\"font-size: 14px;\">黑 </span><br/></p><p><span style=\"font-size: 14px;\">\n</span><span style=\"font-size: 14px;\">6 </span><span style=\"font-size: 14px;\">             </span><span style=\"font-size: 14px;\">日 </span><span style=\"font-size: 14px;\">        </span><span style=\"font-size: 14px;\">   中年</span><span style=\"font-size: 14px;\">             </span><span style=\"font-size: 14px;\">黑 </span></p><p><span style=\"font-size: 14px;\">7              美            中年             蓝\n</span></p><p><span style=\"font-size: 14px;\">9              中            中年             黑\n</span></p><p><span style=\"font-size: 14px;\">10            美            中年             黑 </span></p><p><span style=\"font-size: 14px;\">同样地，我们可以计算这个聚类的中心点是（日，中年，黑）。</span></p><p><br/></p><p><span style=\"font-size: 14px;\">在这个例子中，比较巧合，经过一次迭代后，中心并没有改变，所以聚类就完成了。</span></p><p><span style=\"font-size: 14px;\">也有时候，聚类的新的中心点不一定在数据集中出现，这个也是可能的，我们依旧会使用这个中心点。</span></p><p><span style=\"font-size: 14px;\"><br/></span></p><p><span style=\"font-size: 14px;\"><br/></span></p></div>", "lvl2_answer": ["如果我们把所有的categorical feature都先编码，然后再用KMeans，这样会有区别吗？", "好问题！是的，有区别的。很多地方都有区别，OneHotEncoding之后，我们会有些binary的dummy variable，所以这些列的均值就是在0到1之间，然后这对dummy variable是没有意义的。此外，如果有个categorical feature有1000个level，有的categorical feature只有3个level，做了OneHotEncoding之后，这两个feature的权重就相当于变成了1000比3，严重失衡了。最重要的是，均值和众数本身也不一样。正如KMeans和KMedian的结果也会不同，一个道理。"]}]}