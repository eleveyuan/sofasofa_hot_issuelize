{"id": "1000921", "question": "证明LogLoss是凸函数", "description": "<div class=\"col-md-11 col-xs-10\"><p>这是个后续问题。我之前问了<a href=\"http://sofasofa.io/forum_main_post.php?postid=1000910\">逻辑回归的Log Loss是凸函数吗？</a></p><p><br/></p><p>现在我想知道为什么它是凸函数，因为我还是看不明白为什么它的凸的，最好是有证明的。谢谢！</p><p><br/></p></div>", "viewer": 7423, "tags": ["统计/机器学习", "损失函数"], "answers": [{"lvl1_answer": "<div class=\"col-md-11 col-xs-10 p-r\"><p><span style=\"font-size: 14px;\">严格意义上来说，我们是说logloss对于逻辑回归中任意一个变量的系数是凸的。</span></p><p><span style=\"font-size: 14px;\">下面开始证明</span></p><p><span style=\"font-size: 14px;\">$$L = -\\frac{1}{n} \\sum_{i=1}^n y_i \\log(p_i) + (1-y_i) \\log(1-p_i) $$</span></p><p><span style=\"font-size: 14px;\">其中</span></p><p>$$ p_i = \\frac{1} {1 + e^ { - v_i }} $$</p><p><span style=\"font-size: 14px;\">其中</span></p><p>$ v_i = \\beta X_i $，$ \\beta$ 是逻辑回归的回归系数，$X_i$是第$i$个样本的特征。</p><p><span style=\"font-size: 14px;\">凸函数的复合还是凸函数，并且凸函数的正线性组合还是凸函数，所以我们只要证明</span></p><p><span style=\"font-size: 14px;\">$$F(v) = -\\log\\left(\\frac{1}{1+e^{-v}}\\right)=\\log(1+e^{-v})$$</span></p><p><span style=\"font-size: 14px;\">是凸函数。</span></p><p><span style=\"font-size: 14px;\">要证明$F(v)$是关于$v$的凸函数，只要证明它的二阶导数非负。很容易可得，</span></p><p><span style=\"font-size: 14px;\">$$F'(v)=\\frac{-e^{-v}}{1+e^{-v}}$$</span></p><p><span style=\"font-size: 14px;\">$$F''(v)=\\frac{e^v}{(1+e^v)^2}\\geq 0$$</span></p><p><span style=\"font-size: 14px;\">证毕。</span></p><p><br/></p></div>", "lvl2_answer": ["谢谢分享！", "谢谢！"]}]}