{"id": "1007409", "question": "pyspark里怎么求百分位数？", "description": "<div class=\"col-md-11 col-xs-10\"><p>hive sql里有percentile_approx的函数可以近似求百分位数，pyspark里没有这个函数，怎么在pyspark里求百分位数？</p></div>", "viewer": 4499, "tags": ["算法/数据结构/数据库", "mysql", "Spark", "Hive"], "answers": [{"lvl1_answer": "<div class=\"col-md-11 col-xs-10 p-r\"><p>比如你要对ID进行groupby得到val这列第25和75百分位数，那么可以这么操作\n</p><pre><code class=\"python\">percentiles = F.expr('percentile_approx(val, array(0.25, 0.75))')\nnew_data = data.groupby('ID').agg(percentiles)</code></pre><p><br/></p></div>", "lvl2_answer": ["太牛X了，谢谢"]}]}