{"id": "1005723", "question": "pyspark里怎么把类似‘yyyy-mm-dd‘的字符串转成星期几的形式？", "description": "<div class=\"col-md-11 col-xs-10\"><p>比如表里有一列date_str是yyyy-mm-dd字符串形式的日期，怎么把这列转成星期几的形式？</p></div>", "viewer": 1848, "tags": ["算法/数据结构/数据库", "Spark"], "answers": [{"lvl1_answer": "<div class=\"col-md-11 col-xs-10 p-r\"><p>先引用一下F</p><pre><code class=\"python\">from pyspark.sql import functions as F</code></pre><p>然后用下面的表达式提取星期几</p><pre><code class=\"python\">F.from_unixtime(F.unix_timestamp(F.col('date_str'), 'yyyy-mm-dd'), 'u')</code></pre><p>得到1到7的整数，1是星期一，2是星期二，等等等</p></div>", "lvl2_answer": []}]}