{"id": "1007571", "question": "R错误 predictor not in model", "description": "<div class=\"col-md-11 col-xs-10\"><p>setwd('c:/myr')\n</p><p>getwd()\n</p><p>\n</p><p>data = read.csv(file='c:/myr/Wage.csv')\n</p><p>\n</p><p>age.logit = data$age\n</p><p>wage.logit = vector(length = length(age.logit))\n</p><p>\n</p><p>\n</p><p>\n</p><p>for (i in 1:length(age.logit)) \n</p><p>{\n</p><p>  if(data$wage[i] &gt; 200)\n</p><p>    wage.logit[i] = 1\n</p><p>  else\n</p><p>    wage.logit[i] = 0\n</p><p>}\n</p><p>\n</p><p>#data for logistic model\n</p><p>data.logit = data.frame(age.logit, wage.logit)\n</p><p>\n</p><p>\n</p><p>###################################################\n</p><p>\n</p><p>library(splines)\n</p><p>\n</p><p>\n</p><p>\n</p><p>###################################################\n</p><p>\n</p><p>#generate 3 pieces of spline basis , plot\n</p><p>\n</p><p>###################################################\n</p><p>\n</p><p>bspline = bs(age.logit, df = 3)\n</p><p>data.plot = cbind(age.logit, bspline)\n</p><p>data.plot.sort = data.plot[order(data.plot[, 1]), ]\n</p><p>matplot(age.logit, bspline)\n</p><p>matplot(data.plot.sort[,1], data.plot.sort[, 2:4], type = \"l\")\n</p><p>\n</p><p>###################################################\n</p><p>\n</p><p>#logistic cubic spline regression\n</p><p>\n</p><p>###################################################\n</p><p>\n</p><p>fit  = glm(wage.logit ~ bs(age.logit, df = 3), family = binomial(link = \"logit\"))\n</p><p>summary(fit)\n</p><p>\n</p><p>fit=update(fit)\n</p><p>\n</p><p>#logit prediction\n</p><p>\n</p><p>newdata = seq(20,60)\n</p><p>newdata1 = list(age.logit = newdata)\n</p><p>n&lt;-1000\n</p><p>age&lt;-50+12*rnorm(n)\n</p><p>pred = predict.glm(fit, newdata = list(age.logit = newdata),se.fit = TRUE)</p><p><br/></p><p>\n</p><p>HRpred = Predict(fit,newdata,fun=exp, ref.zero = TRUE)   #报错</p><p><br/></p><p>Error in Predict(fit, newdata, fun = exp, ref.zero = TRUE) : \n</p><p>  predictors(s) not in model: newdata</p><p><br/></p><p>为什么使用Predict就不行呢</p></div>", "viewer": 3140, "tags": ["统计/机器学习", "回归分析", "R"], "answers": [{"lvl1_answer": "<div class=\"col-md-11 col-xs-10 p-r\"><p>将fit =<font style=\"background-color: rgb(255, 0, 0);\"> glm</font>(wage.logit ~ bs(age.logit, df = 3), family = binomial(link = \"logit\")) 改成fit =<font style=\"background-color: rgb(255, 0, 0);\"> lrm</font>(wage.logit ~ bs(age.logit, df = 3), family = binomial(link = \"logit\"))就可以了</p></div>", "lvl2_answer": []}]}