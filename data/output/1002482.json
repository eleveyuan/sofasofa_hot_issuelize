{"id": "1002482", "question": "怎么对pyspark dataframe更改列名", "description": "<div class=\"col-md-11 col-xs-10\"><p>怎么对pyspark dataframe更改列名？</p><p><br/></p><p>我不是问的pandas dataframe，是pyspark.sql.dataframe.DataFrame。</p><p><a href=\"http://sofasofa.io/forum_main_post.php?postid=1000532\" target=\"_blank\">（pandas更改列名的方法在这里。）</a></p></div>", "viewer": 13513, "tags": ["统计/机器学习", "Python"], "answers": [{"lvl1_answer": "<div class=\"col-md-11 col-xs-10 p-r\"><p>kidd23的方法比较麻烦，直接用withColumnRenamed就行了</p><pre><code class=\"python\">new_df = df.withColumnRenamed('old_name', 'new_name')</code></pre></div>", "lvl2_answer": []}, {"lvl1_answer": "<div class=\"col-md-11 col-xs-10 p-r\"><p>假如你要把df中一个叫old_col的列改成new_col，可以用以下的代码，其他列则不改变</p><pre><code class=\"python\">import pyspark.sql.functions as F\r\nnew_df = (df\r\n          .select(*[F.col(s).alias(new_col) if s == old_col else s for s in df.columns]))</code></pre><p><br/></p></div>", "lvl2_answer": []}]}