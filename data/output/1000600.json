{"id": "1000600", "question": "sklearn中的predict_proba方法的返回值的意义", "description": "<div class=\"col-md-11 col-xs-10\"><p>我用sklearn模块进行退货预测，我调用predict_proba以后，发现返回给我的不是概率向量（我有n个预测样本），而是一个n行2列的矩阵，</p><p>这个矩阵是什么意思？这个predict_proba返回的是什么概率？</p></div>", "viewer": 28858, "tags": ["统计/机器学习", "监督式学习", "Python"], "answers": [{"lvl1_answer": "<div class=\"col-md-11 col-xs-10 p-r\"><p>predict_proba返回的是一个n行k列的数组，第i行第j列上的数值是模型预测第i个预测样本的标签为j的概率。所以每一行的和应该等于1.</p><p><br/></p><p>举个例子</p><pre><code class=\"python\">&gt;&gt;&gt; from sklearn.linear_model import LogisticRegression\n&gt;&gt;&gt; import numpy as np\n&gt;&gt;&gt; x_train = np.array([[1,2,3],\n                        [1,3,4],\n                        [2,1,2],\n                        [4,5,6],\n                        [3,5,3],\n                        [1,7,2]])\n&gt;&gt;&gt; y_train = np.array([0, 0, 0, 1, 1, 1])\n&gt;&gt;&gt; x_test = np.array([[2,2,2],\n                       [3,2,6],\n                       [1,7,4]])\n&gt;&gt;&gt; clf = LogisticRegression()\n&gt;&gt;&gt; clf.fit(x_train, y_train)\n# 返回预测标签\n&gt;&gt;&gt; clf.predict(x_test)\narray([1, 0, 1])\n# 返回预测属于某标签的概率\n&gt;&gt;&gt; clf.predict_proba(x_test)\narray([[ 0.43348191, 0.56651809],\n       [ 0.84401838, 0.15598162],\n       [ 0.13147498, 0.86852502]])</code></pre><p>预测[2,2,2]的标签是0的概率为0.43348191，1的概率为0.56651809</p><p>预测[3,2,6]的标签是0的概率为0.84401838，1的概率为0.15598162</p><p>预测[1,7,4]的标签是0的概率为0.13147498，1的概率为0.86852502</p><p><br/></p><p><br/></p></div>", "lvl2_answer": []}, {"lvl1_answer": "<div class=\"col-md-11 col-xs-10 p-r\"><p>对于一个k元分类</p><pre><code class=\"python\">probas = clf.predict_proba(test)</code></pre><p>probas是一个k列的array</p><p>probas[:, j]这一列是每个test样本为j的概率。</p><p>probas[i, j]是预测第i个样本的标签为j的概率。</p><p><br/></p><p><br/></p></div>", "lvl2_answer": []}]}