{"id": "1000759", "question": "tensorflow里面怎么自定义一个loss function？", "description": "<div class=\"col-md-11 col-xs-10\"><p>我的模型的loss function是自己设计的，有没有人了解tensorflow里面怎么自定义一个loss function？</p></div>", "viewer": 8351, "tags": ["统计/机器学习", "Python", "损失函数", "TensorFlow"], "answers": [{"lvl1_answer": "<div class=\"col-md-11 col-xs-10 p-r\"><p>有两个办法：</p><p>其一、你自己用C++写一个。你需要把tensorflow的源代码下载下来，然后自己用C++写一个函数。可参考<a href=\"https://www.tensorflow.org/extend/adding_an_op\">Adding an op</a>。</p><p>其二、你把你自己定义的损失函数用tensorflow中的标准函数表示出来。比如你需要MSE（虽然这个已经有了），可以写成</p><p>loss = tf.reduce_mean(tf.square(tf.sub(y_real, y_pred)))</p><p><br/></p><p><br/></p></div>", "lvl2_answer": []}, {"lvl1_answer": "<div class=\"col-md-11 col-xs-10 p-r\"><p><span style=\"font-family: Arial; font-size: 14px;\">比如说你有一个function: f(x1,x2) = exp(x1)/(exp(x1)+exp(x2)) 或者可以写成 f(x1,x2) = 1/(1+exp(x2-x1)).</span></p><p><span style=\"font-family: Arial; font-size: 14px;\">你可以这么定义：</span></p><pre><code class=\"python\">x = np.float32(np.repeat(0.5,2).reshape(2)) \n\nvarX = tf.Variable(x, name='varX', dtype=tf.float32)\n\nvarX1 = tf.slice(varX,begin=[0],size=[1])\n\nvarX2 = tf.slice(varX,begin=[1],size=[1])\n\nf = -1./(1+tf.exp(varX2-varX1))\n\nopt = tf.train.GradientDescentOptimizer(your_learning_rate)\n\ntrain = opt.minimize(f)</code></pre><p><span style=\"font-family: Arial; font-size: 14px;\"><br/></span></p></div>", "lvl2_answer": []}]}