{"id": "1002479", "question": "F1值会受到不平衡数据的影响吗？", "description": "<div class=\"col-md-11 col-xs-10\"><p>现在的用来做二元分类的数据集是严重非平衡的，我想知道在这种情况下，F1值还适不适用？数据非平衡对F1值有什么样的影响？</p><p><br/></p></div>", "viewer": 6858, "tags": ["统计/机器学习", "监督式学习", "模型验证"], "answers": [{"lvl1_answer": "<div class=\"col-md-11 col-xs-10 p-r\"><p>当然有影响的。</p><p>看下图，横坐标是数据中阳性样本的比重，纵坐标是一个随机预测结果对应的F1值，可以看作是baseline。阳性样本的比重不同，baseline变化很大，所以数据的平衡性对F1值影响还是很大的。</p><p><img data-filename=\"f11 (1).png\" src=\"data:image/png;base64,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\" style=\"width: 445px; height: 304.293059125964px;\"/></p><p>代码如下</p><pre><code class=\"python\">from sklearn.metrics import f1_score\r\nimport numpy as np\r\nimport matplotlib.pyplot as plt\r\n\r\nfracs, f1s = [], []\r\nfor frac in np.linspace(0.01, 0.99, 20):\r\n    n = 1000000\r\n    n1 = int(n * frac)\r\n    n0 = n - n1\r\n    true = [1] * n1 + [0] * n0\r\n    pred = np.random.randint(0, 2, n)\r\n    fracs.append(frac)\r\n    f1s.append(f1_score(true, pred))\r\n    \r\nplt.plot(fracs, f1s)\r\nplt.xlabel('% of positive labels')\r\nplt.ylabel('F1 score of random guess')\r\nplt.show()</code></pre><p><br/></p></div>", "lvl2_answer": ["谢谢！"]}, {"lvl1_answer": "<div class=\"col-md-11 col-xs-10 p-r\"><p>关于非平衡数据以及各种metric对应的表现可以看看这篇<a href=\"http://www.pitt.edu/~jeffcohn/biblio/Jeni_Metrics.pdf\" target=\"_blank\">Facing Imbalanced Data</a></p><p><br/></p></div>", "lvl2_answer": ["谢谢！"]}]}