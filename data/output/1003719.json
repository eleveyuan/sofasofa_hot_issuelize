{"id": "1003719", "question": "怎么利用python对时间序列中缺失值进行线性插值？", "description": "<div class=\"col-md-11 col-xs-10\"><p>时间序列应该是每天一个数值点，但是有时候会有缺失值</p><p>比如</p><p>2018-01-02 y=100</p><p>2018-01-04 y=120</p><p>这里1月3号的信息是缺失的，我希望是对这个缺失值进行线性填值，得到</p><p>2018-01-03 y=110</p><p><br/></p><p>有时候，可能会连续缺失几天信息</p><p>比如</p><p>2018-01-02 y=100</p><p>2018-01-05 y=115</p><p>这样就需要填充两天</p><p>得到</p><p>2018-01-03 y=105</p><p>2018-01-04 y=110</p><p><br/></p><p>python里如何方便地实现这个功能呢？</p><p><br/></p></div>", "viewer": 13735, "tags": ["统计/机器学习", "数据预处理", "时间序列", "Python"], "answers": [{"lvl1_answer": "<div class=\"col-md-11 col-xs-10 p-r\"><p>方法如下</p><pre><code class=\"python\">import pandas as pd\nd = pd.DataFrame()\nd['date'] = ['2019-01-01', '2019-01-02', '2019-01-04', \n            '2019-01-07', '2019-01-09', '2019-01-11']\nd['val'] = [10, 20, 30, 40, 50, 30]\nd['date'] = pd.to_datetime(d['date'])</code></pre><p>上面的代码可以生成一个dataframe，如下</p><p><img data-filename=\"221 (1).png\" src=\"data:image/png;base64,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\" style=\"font-size: 1rem; width: 139.86363636363635px; height: 181px;\"/></p><p>下面我们需要生成一个辅助dataframe，包含从2019-01-01到2019-01-11的所有日期。然后再将helper和d join起来</p><pre><code class=\"python\">helper = pd.DataFrame({'date': pd.date_range(d['date'].min(), d['date'].max())})\nd = pd.merge(d, helper, on='date', how='outer').sort_values('date')</code></pre><p>现在得到的d是</p><p><img data-filename=\"222 (1).png\" src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOgAAAHMCAMAAADoPRTeAAAAllBMVEX////19fXZ7f0AAADt7e0VFRXMzMzExMSrq6ujo6Pk5ORra2shISFKSkp1dXWYmJiAgIDX19e2trZVVVWOjo4qKyvf399dXV28vLyGhoY6OjoLDAwzMzTR0dFkZGTK3ezR5fSuvsuSn6pcZGtAREdKUFWhr7tyfITF1+aIlJ1RWF6mtcFlbnWZprJtd357ho+9z964yNYUao0oAAAUwUlEQVR42uyc2XbTMBRFfXMkT7E8xI4zOSGlKbTM/P/PoSFBAcstTSiEoP3QWL7H19qWFWAtVgOPx+PxeDz/Kum6Cn4rlWx4iSRAeOxdFFFwFjU4Cy6Q+EfRCiiCsxhfoij1RNtrFI0EeGJe3fmsQ5dXQbGB/JwEwURgNW6f2o65ilKZN3TocImiMTRKtIShqqFo5Gw16+BR1oCgoALGtsPliVIGlNFMiaYAD1kOxGECjOcsAURUAFN6vMUSPA1kOLIdLk90DmzkXDsgpCSOAiqAQu9RdTJLSS1r+ORX9iTYISPb4fJEYyA6/PFCcc4hKcy3Lk2heVK0BcYpUAb7DpcqGu5FUw5AiJ9Fp90qCh6FduCl6rPvcJGiE70SgQDUxlxQEB6LZiQ1wpCe/usGVHbf4SJFGYCYFQDCGIgDOqxoF1UlsGCVANrgcVJIFkFgOlzmigYN9oQR9hRaHw3jgFF4CmE2su5woXvUmIqZmmgBgI+BXK4NV7NN5WmsCvqVnb5UKdshR3ZpogExZo/o+1myZ34Zk/d4PB6Px+PxeAbBleFF6crwonRleFG6MrwoXRlelK4ML0pXhhelAdIwbOkf5LmiOSRjRm7mG1E3uhhthFikpKl4RYpJLerCXuoODZfcsG5iQrkQeUgKOzxdNIdmRk4WUGQpUWyOzNqPEZkPxdKa9kPDpUESNCRZQ2OCdniqaAtgMgewJgcReEjtDCWxDDGxMRZEk2ZqbjhBV1FVoyCDKzRcchMWNYzoDAtGBZaksMNTRROg0T8Ld3WiHgYXUirX080YjVcdR/R9XVp7c1douDQwn+lUi1amrUBI1BueIFoAoWqDkhxMlqpvCLFXphlP9XT0RDdQVcblOY0zNFgaZK1FQzOjYp+0wxNFZ3oDsikEDcEECkrMoxwfT7REodfKijpC7tLTomsUNmmHJ4uW4K0WrWmAaoolUyvSm2gEJOmcK9E2TdPWGbKl54rmNmmHZ6wobx9d0QKYMX2H/kRLaHiaQLJKXSFb+rsrmgCRaoMFuUg78InJzR17bN0sklRkbJKXZZkzV8iWnrtHFzaph+eJxo9+67IOOSPFBOXhW9O+uoWadYUZKdyh4dKw6It866YciGNgVbnXOydDy7lMNGpsF0srbpDQcKhf+kVRWqpdHSFjtI7Do+GJotRAkw/t4FrSxUQ5VosZENqJqp09zQWmjAyuUK/0y6IxkOdAodKLo+GpolRA0pATAYUpl4DZr3ai7QxAnZKlHxouDYsW+5Ck0AeFHZ4uSixNGfVw5tzn3Cec2eeRpj8N/b9Hveg14EXpyvCidGV4UboyvChdGYHH4/F4PB6Px+M58L/8DbkCwqFaNBZ1oR9DOBaiYeZsy1v9OZ+JOiGb7oX6JdvTTVUKUeoLU3mUV+asHZ4BiWHRBopMzi8+HClyhOZDsbRz7of6JdvTRQRNKI0PRxo7PJVJ/sj1Ifg6YBssAsowCWiMRl5RTM0FcyzboK2RBAZXqF+yPR0wGSNq1MOboSEq1JHGDk+kfuxBJZiru3NBc5R6uhkF6n+V6AvG+mdqb+4K9Uq2p3MX6ZjgbN+2RqULR8MTKaaCD4pGy0rfXVCMuX6unJn30IiqKnF5zuAK9Uq2Z9AnFbFqOeWsMkue7JvY4bm/8GMYEkgOsx4fO5Qo9K6yoo5Qr2R7DtJgI82K4yZ2+GKi7RRLUivScwiBhEUcnBFTOEO9ku05AG3AW/MSH4uWLytKBbChgcVaQMNZDMmKuUK9ku3pZg5kafCnV5R14HOTiRzbryqamImMIv1fT8gV6pVsTyclkJA2a+ymtMMXEqUOOe2f8+LwhWpf3UIJpdjohDvUL9mebs9l6/qatcMXEY1RBgbGuZxAgTw4Wiz9Ao4RB8OhXsn2dFEpHw3tMFFfA/KhVXF4NHwR0Q34rK7rpbxHjlUzA9ZHDjRFlwv7y8NcoX7J9nSQABtR10I+iwmQl0CiTjZHw7NEV627ImAopFUJgEfBsUM6A1Azm++FHCXb00GBDgpB+vkbsVhm7fDlIcbc59wnXNln35D878DxeDwej8fj8fwCoyvDi46uDC86ujK86OjK8KKjK8OLjq4MLzoaYPv15svoH+S5om8gyb4OVN/f7u4eturo5na3e/vKnP3Cv5hr3+mqwRVylj6aq1y8RmcKt9m+ixnhk/7cTu9OFn0Pjezr4vP34kdzdK9Pf8CN+VB0ds79kKP01hxt3aJ4a9T4j6J4c6bodip7bGWj167qDfjX0f07efNtho8jmfssl/HzFNrhDbovo/s7POzTrlC/9BWZ7vl6QBQ3TtHs1XmiN1DTevX5w0dX9UE/yHu+k1Kf9HTlQtyuOq5nc6t/3mO5T7tC/dID3usX6bNb9E6vtRG9+bDr7j5v5Uievj1P9AF4+LS7+zjwXi/V3v2KnZyBfnfemQf9ei+qqlt+ePjOUK90/15Wt+/Qv6W55hPe7kXfA6sO+KB27H2HN2eJ3sKw3I6G2O7wcJj17bHDJzzotbGijpCr9OUd5LMbEN1muDHBO+X2le/U6Bs7Z9DbKAxE4axfvdJWvlQKPRSqMQkEDBSS///nNjNQcbB9IW0P1N8FknkRfvHMYA7YltD0qNFhAtdohGuGwvKMeB5KwFGveQQtEbVBUSjkAOhbxKjqYawIL47TydTzzxqcHzHaAY203lqFcUBnI5PVQNB04kNOIZEfYmjAW8yo3ExEeJ06AItRm+FDPVSjJed+JJWogL7MI+gD5XebmhNVxvbDOI6DDYm80PViuR4KTTGjZFCO9/AIVI1bjHICmWux2egFmCQJz8HyLDDYRdd8NtQ1dR1J1+1EERb5oRqtWI4ZFXGuNbUwrMwqMSoJlGGzUdKA6w1iTXBczlrN6xzHLXCdLLF4xknFRX5owCTrB2NjRqVzaLrB3E/XGeW822pUrigUkQrWXV3XxQevc/KmA8p1PHzhbKjWEYdEfqjlhKz4n40bJQNN1sxCuNmoJF61zag41QAnaIgKM9PSebQU2tpQpVfQqvdEodCtApD1kUoql6OxsjrN3RlvqpmNcufdaFRoW89mCEsU/y4u8kKeKI5lHdn0PJqM7opkVO2MZFTtjGRU7YxkVO2MQyKRSCQSiUQikZj58/L+evgFHHHHvPzcXinyIf97CPPOsudv2CvlCEE//9ReKcxThmPsnX0mf/3yvVKeNPDvP3vnruMwCERRri5ex4sfYNk46yj5/89cBbtLSEWmQHMKF0ZidDVAx6FdyUnKlfLEZeoZrLerwUJnSrtSAjmmr5NypaRpXSZooD8Llr61fyHbI66UKyV5T2Kuo21MG8ab0q4UhACDjZzEXClYe4R8vV/Xs7FfMWuElewh5koZeTefgjYk52+4UjqSuxVzpczsjgZlwYWNLd5RbCQnyLlSHhy2x578Da/Ea/rr+VPclbKRQzRGzpXieNDYt6trPvOUPnVbkvvkvV8g5EpJ3DNLd+aA5yhDaVfKH08GCLlSErk9ip3N4sixuCvF88RJuVISMXcYYSR562Dqd6XAWnWlKIqiKIqiKG/Rp4pQGRoUlaFBURkaFJWhQf/ZObcdt0EgDHf0gx1jcIzxIXYOV33/Z2wGQqtVQGrXkqVGfDdWMhPgw0A2Wmvowyii9GH8m6iI0H/Hv4k2eHGiJJeHcaOfhfphzKrIY6UlZnDGnQUFUkmp0NyPT/p7eji30FyrFf2hRUeMmNw+0QkYKcUKhjs9gdHzq+M6XJgtmqaSEqEBnktmOH34sPwqimGnqDXOuQVAQwlqyIrmBT0JjROJFivRME7wDgNulqzDmQKppERovFbqSXbe66SoVrtEow+6dL9+ImdpaPAZQmtB/oGT+vctm7FRIJWUCC0TZWngoEUUrTpz8xunhUO7X1RMvPxSDFtFRBXMS5mWMNGNd3iAo0LGyU8mvYXEdF2NG3N3tOrQv0QvoVZKxzvWbhh2izZATXmEwZlHQKH/Pw69X7QDomgy6S1k4ZFzeii10KhDG47dKmn4lagg1U5RoWEoj/X3u8Hw5lADjbpIHsGslJqTSW+hCsbSbNBmRGngxfuQigaex0q70GKPdqfoOXy35KOL8CN4d+jhkarhy1Wlkt5DyutLLTKi1KILbdjRAXiJigkD7RLd+JZkUDfIIYzgkth+93FtlNFi8I+eiFRSIsTwLcuJKo26e4Y7wPTnKEo1tL3tEJ1lfuWKGzpBzIA+npp/lu6Zx2qxEJNOeg+N0voDMCfqk69SqhmaMycT10iPCTtEa2DMH1Pd7+ng8Y3ovoyHFR9oKJ/0HhrR+qCjjKhvE7yZp5AYRcWEPaIN0FCGBdI9uZ2IOlzXBajieELHU2cwCQqkkt5DM/hTPikrqjSk4kNyNQDOcZ3XgPm+6Jn7zGAQGF8njxy+jGdeADhFkURSImS5VZPucwifCSfv4B9QabFRH0T55D3gZ5pQKv9ePikREkr8bZdEFJPL79Ei+iEUUfowiih9GEWUPowiSh/Gj0KhUCgUCoVCoRAQ9q5+fD7igSdGHFgrRYzm1tpMWYgtNNdqTo206P2VJkff9KSf8Ex0WK0UJcFUaVGsQU1+FcVlp6gFjOK7Wh1UK4WntiE6YcmIokqKarFT1M/VDFRH1Uq5o/dvDGlRB01R9O6fSiHuyaHdI+oV+/AftaNqpTzfvp/HE2X2aNVjfYnWwHUDOt6xasNlj2jchTzLB9VKaeCRNiNKGlVow7GblYaer6iCFHtEqYPHiKNqpTyAXs0PbJQWfc6cJt/GhY97q114taLdIzoCD2sd0B5VK2XFw9fskCoj6r9MfBvzeQHwEqUJww7RFlD+TDR0UK0Urqrw5CfqnKjQqPpnG318KiVoV9DzbY/oHEWPqZUyhPIuDjYt6pOvUgoFrfj8MV7UL6AJ3xbtgM3aBXBH1UpRkHO26klc4YAU1v8V08DFzUATvi+qJGLdtqNqpaxA34GnJysqNKTgZTYaAOe46yvwwvsmqsWTB3seVStl5IlNePpFW4Ur3/Da57XYaA2ifPLuq4FCB9VKSSblIeKRlQophUKhUCgUfrV3dsttwkAYzc4n8WvAYGObeOyrvv8zFi/ubGcs+kMkdazuuXCRKpGeYkgy054oirZSVPS9UVFKDBWlxFBRSgwVpcRQUVrhlGUVvSF/KWpqzBzcqiFaKf10ZCZDK1Rjx/vbpmkzYmS4WbQGMxp6JUgrpcPCtaIVzmiI6AYmJ0aGG0V7wOb56ExOhGmlVP3MiRe5KYED606Gf2QPI8ONogV3ZQanaJhWigzdZLjbWbRfTtsg41kZbhTNu67n+zSjF4K0UiQ34caMY/WoLWRL76fjk7wMtyVEGgA1reC9lUIz7XrLo0XGoZAbOjmJDL8kagE0FTnx30rh9+FoyE0xCz1FWzkJD78sStnwDdiTiwCtFN5XkhvOdAS5ouXhYB7nd2ZEArVSzOhu/PAeez40wJhlmH7+SDLcKLp0MDKnaJhWyrwPB1qhwJPc91O3BOwwjM63bpBWCv9GR7/CPBJGxEmqHDtDtyIjGW4S5WvGSJ1OCNJKkS+ZVlnyTAXQtkD3ONEkw+1f67aYaV2eQVop7Jz9WnSpFpXAIlaik+FXUlzVn6RL/LRS/o7nBhnq96MqmgIqSomhopQYKkqJoaKUGB+KoiiKoiiKoixUt5v5SB86YGZPkVopchS7lfIpHYZIrZQSD2wVt5VyAWw2v+AUrZWyu+YfdEQXt5UyARc+fxGrlVLZA6dL2ritlBrWLMWUWK0UGq/z/IQubiul5WtZYnaJ1EqZN2C0GCluKyUHMO051BGplfIMj8yXNUYrRThjoaFIrZQLrjnRfraJ0koRLvW9LYDjR7RWysD3g62itFJEc6r4HmWdGK2Up3J9PUVtpWRAU13Ab6Q4rZSC/7A5bMxWilTk8o9YrRQaYY810EVupVAteZM4rRRT/7tWyoe2UhRFURRFUZR3hhJDRSkxVJQSQ0UpMVSUEkNFKTFUlNYxht6PDaJn4EYuArRSZJebpaMykL9WilBiJawRpJUiu1z0YCZ/rRQhw4pomFaK7HKRo6hmjLdWimDGNdEwrRTZ5aK88tvBXytFuMPe3aJhWimyixy02B+afR+glVICecGibry3UmQXvWI+wVy8lzUyoKMCyMiN/1aK7HKJ7mxOZo+d8d1KOQPF0ALHC7kI0EqRXeRg+Yz+icz3Fa2x4Hw2BGmlyC5agbf6b6UwEVspssvBBQXN1P5bKWaGOuBCr4RppcguBzl2FX/6rjy3UuTJS6+EaaXILhefuLZ3oPPZShEGt2iQVorscsLpFlsQeWilbMNPK8W9yL1MWykqqqLvjYpSYqgoJYaKUmKoqKIoiqIoiqL8LxAR/2r6tFsp/dKwoBYzddhWikzEb6VQs4juwdzDtlJkQhZFaaUMLcCiFYAhB9AHbaXIhCyK0ko5gEX5zN3yGraVIhOyKEYrpRsby6IlcONWyhS2lSITsihSK6Vg0Tu/J2gM3UqRCVkUoZUiohMsi4ZupciELIrSSpEruoiGbqW4rmiEVoqIlvzaB2+lyIQsitRKKV6euiFbKTIhiyK0UkTUWKAYgOspbCtFJmRRhFaKiM4fkdmHbaXIhCyK1UopnlexxMyRQrdSZEIWxW+lUNBWiqCtFEVRFEVRFOWJtlL03xmpqIq+LypKiaGilBgqSomhouTGPHjHWMpfit7AWKept1aKTMiRm6yez9ATeW+lFL/4P/T+WikyIUdOBjy49v5bKUfsymLG0AseWykyIUcuzHgdyBxR+2+l3HGmFXy2UmRCjhxkfIbKNt5bKWaEvePaVvSKz1aKTMiRA3Pp+YZpvbdSThY/bkM3W1opG0SFvt7BViFaKXYoLHAkJ55aKW7R9b/6gXy3Ukyec+EBDbnw1kpxi7oxJezJ9xVdYgBmdIp6bKX8oWg/8NY2SCsl4yt6oBd8tlL+ULREQTOd/1bKke9RwJku2d5K2SpaoDH84Lj5bqWYcT1+s72Vsll09rHTHWj9t1KqGjN7Q69sb6VsF11+vA/reG+lmNPJ0G/Z0ErZgrZS9BtvFU0GFaXEUFFKDBWlxFBRRVEUJTDfAS0dvXuW5zh3AAAAAElFTkSuQmCC\" style=\"width: 146.5px; height: 290.4741379310345px;\"/></p><p>最后一步就是插值了，直接用interpolate方法，method选择linear，线性</p><pre><code class=\"python\">d['val'] = d['val'].interpolate(method='linear')</code></pre><p>插值完的d如下：</p><p><img data-filename=\"223 (1).png\" src=\"data:image/png;base64,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\" style=\"width: 186.35897435897436px; height: 316px;\"/><br/></p></div>", "lvl2_answer": []}]}